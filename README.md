# **Geo-Elevation Interpolation Project**

## **簡介**
本專案旨在解決地理高程數據缺失的問題。通過克里金插值法（Kriging Interpolation），根據已知的高程數據（原始高程資料）估算未知點的高程值（需求高程資料）。專案提供了一個簡單易用的 GUI 界面，用戶可以透過視窗選擇輸入檔案與保存位置，並自動生成插值結果。

此工具適用於地理信息系統（GIS）、土木工程、環境科學等領域，特別適合處理稀疏數據或需要快速估算高程值的場景。

---

## **功能特點**
1. **克里金插值**：
   - 使用 `pykrige` 庫實現高精度空間插值。
   - 支持線性變異函數模型（可擴展至球面或高斯模型）。

2. **GUI 操作界面**：
   - 提供直觀的文件選擇與保存功能。
   - 適合非技術用戶操作。

3. **數據清洗與格式化**：
   - 自動處理千位分隔符號（如 `187,575.25` → `187575.25`）。
   - 格式化插值結果，保留小數點後兩位。

4. **錯誤處理與防呆機制**：
   - 檢查輸入數據的有效性。
   - 提供詳細的錯誤提示，避免程序中斷。

---

## **安裝與執行**

### **1. 環境準備**
- **Python 版本**：3.7 或更高版本。
- **依賴套件**：
  ```bash
  pip install -r requirements.txt
  ```
  `requirements.txt` 內容如下：
  ```txt
  pykrige==1.7.2
  pandas==2.0.3
  numpy==1.24.3
  ```

### **2. 專案結構**
```plaintext
geo-elevation/
├── main.py               # 主程式
├── requirements.txt      # 依賴清單
├── README.md             # 專案說明文件
├── 原始高程資料.csv      # 已知高程數據範例
└── 需求高程資料.csv      # 待插值數據範例
```

### **3. 執行步驟**
1. **啟動程式**：
   在終端中執行以下指令：
   ```bash
   python main.py
   ```

2. **選擇檔案**：
   - 選擇包含已知高程數據的 CSV 檔案（如 `原始高程資料.csv`）。
   - 選擇包含待插值數據的 CSV 檔案（如 `需求高程資料.csv`）。

3. **保存結果**：
   - 選擇插值結果的保存位置，生成新的 CSV 檔案。

---

## **輸入與輸出**

### **輸入檔案格式**
#### **原始高程資料**
| Manhole | Ground Elevation (m) | Sump Elevation (m) | Structure Depth (m) | X (m)        | Y (m)         |
|---------|-----------------------|---------------------|----------------------|--------------|---------------|
| 1BHd06  | 15.84                | 12.84              | 3                    | 187,575.25   | 2,503,847.37  |

#### **需求高程資料**
| Manhole | Ground Elevation (m) | Sump Elevation (m) | Structure Depth (m) | X (m)        | Y (m)         |
|---------|-----------------------|---------------------|----------------------|--------------|---------------|
| 1BHd02a |                       |                     |                      | 187,459.41   | 2,503,951.28  |

### **輸出檔案格式**
| Manhole | Ground Elevation (m) | Sump Elevation (m) | Structure Depth (m) | X (m)     | Y (m)       |
|---------|-----------------------|---------------------|----------------------|-----------|-------------|
| 1BHd02a | 15.68                |                     |                      | 187459.41 | 2503951.28  |

---

## **技術細節**
1. **插值方法**：
   - 使用克里金插值法（Ordinary Kriging）計算未知點的高程值。
   - 變異函數模型：預設為線性模型（Linear Variogram Model）。

2. **數據處理**：
   - 千位分隔符號處理：將 `187,575.25` 轉換為浮點數 `187575.25`。
   - 插值結果格式化：保留小數點後兩位。

3. **錯誤處理**：
   - 檢查已知點與待插值點的有效性。
   - 若無有效數據，彈出錯誤提示。

---

## **常見問題**

### **Q1: 為什麼會出現 `CREATE_VENV.PIP_FAILED_INSTALL_REQUIREMENTS` 錯誤？**
- 可能原因：
  - `pykrige` 的版本在 `requirements.txt` 中指定錯誤（如 `1.5.6` 不再存在）。
- 解決方案：
  - 更新 `requirements.txt`，確保使用最新穩定版本（如 `pykrige==1.7.2`）。

### **Q2: 插值結果是否準確？**
- 插值精度取決於已知點的密度與分佈。若已知點稀疏，建議增加數據點或使用其他插值方法（如 IDW）。

---

## **未來改進方向**
1. **支持更多插值方法**：
   - 新增反距離加權法（IDW）或其他插值算法。
2. **數據可視化**：
   - 添加高程分布圖或等高線圖。
3. **批量處理**：
   - 支持多組數據的批量插值。

---

## **貢獻與聯繫**
如果您對本專案有任何建議或想參與開發，歡迎提交 Issue 或 Pull Request！

聯絡方式：
- Email: [your_email@example.com
